# Функции

## Три способа объявления функции

    function sum(a, b){
      return a + b;
    }

    let sum = function(a, b){
      return a + b;
    }

    let sum = (a, b) => {
      return a + b;
    }

Сокращаем стрелочную функцию:

    let sum = (a, b) => a + b;
    let double = a => a * 2; // один параметр, можно писать без скобок
    let d = () => 2 * 2; // ноль параметров, скобки нужны

## Лаконичный код
Стрелочные функции позволяют создавать лаконичный код с фильтрами. Однако главная её задача это сохранение контекста.

    let users = [
      { id: 1, name: 'Дмитрий', role: 'admin' },
      { id: 2, name: 'dfds', role: 'agent' },
      { id: 3, name: 'dsfdfs', role: 'admin' }
    ];

    // Выводим администраторов - стрелочная функция
    console.log(users.filter(user => user.role === 'admin'))

    // Выводим администраторов - обычная функция
    console.log(users.filter(function(user){
      return user.role === 'admin';
    }));

## Сохранение контекста
Стрелочные функции сохраняют контекст, откуда были вызваны.

Обычная функция (динамический контекст):

    /*
      По клику по диву, через 1 секнду шрифт изменится на красный.
      Функция обработчика события вызывается в контексте элемента в котором событие произошло.
      Внутри setTimeout вызывается уже другая функция и её, браузер как функцию для setTimeout,
        вызывает уже в контексте объекта window.
    */
    document.querySelector('.sample').addEventListener('click', function() {
      // let that = this; // ссылка на this, на нужный контекст (можно еще через e.target, e.currentTarget),
      // функция внутри setTimeout видит эту ссылку по замыканию
      // эта ссылка живет на секунду дольше

      let div = this; // тут this это .sample
      setTimeout(function() {
        div.style.color = 'red'; // тут this это window
      }, 1000);
    });

Стрелочная функция (статический контекст):

    /*
      Стрелочная функция полностью отвергает понятие динамического контекста.
      Стрелочная функция при создании сразу привязывает к себе контекст.
      Контекстом будет тот this, на какой строчке кодая объявлялась стрелочная функция.
      Хочешь узнать какой контекст у стрелочной функции посмотри на код выше.
      Например обработчиков события нельзя делать функцию как стрелочную, ссылаться будет на window,
        а не на элемент вызвавший событие.
    */
    document.querySelector('.sample').addEventListener('click', function() {
      setTimeout(() => {
        this.style.color = 'red'; // тут this это .sample, сохранён контекст клика
      }, 1000);
    });
